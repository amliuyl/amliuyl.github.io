<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>线性代数算法竞赛模板 | liuyl's blog</title><meta name=keywords content><meta name=description content="算法竞赛中线性代数基础应用的代码实现模板"><meta name=author content="liuyl"><link rel=canonical href=https://liuyilong.com/p/tech/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B%E6%A8%A1%E6%9D%BF/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.521ab9c2c4949eead7bcee2b18b3fdaac0ab5200af213f1b75ece8f778f0f1e0.css integrity="sha256-Uhq5wsSUnurXvO4rGLP9qsCrUgCvIT8bdezo93jw8eA=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://liuyilong.com/avatar.jpg><link rel=icon type=image/png sizes=16x16 href=https://liuyilong.com/avatar.jpg><link rel=icon type=image/png sizes=32x32 href=https://liuyilong.com/avatar.jpg><link rel=apple-touch-icon href=https://liuyilong.com/avatar.jpg><link rel=mask-icon href=https://liuyilong.com/avatar.jpg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css integrity=sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0 crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js integrity=sha384-PwRUT/YqbnEjkZO0zZxNqcxACrXe+j766U2amXcgMg5457rve2Y7I6ZJSm2A0mS4 crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],throwOnError:!1})})</script><style>.katex-display>.katex{white-space:normal}</style><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css><script src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="线性代数算法竞赛模板"><meta property="og:description" content="算法竞赛中线性代数基础应用的代码实现模板"><meta property="og:type" content="article"><meta property="og:url" content="https://liuyilong.com/p/tech/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B%E6%A8%A1%E6%9D%BF/"><meta property="og:image" content="https://liuyilong.com/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="p"><meta property="article:published_time" content="2023-03-28T04:21:30+08:00"><meta property="article:modified_time" content="2023-03-28T04:21:30+08:00"><meta property="og:site_name" content="liuyl's blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://liuyilong.com/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="线性代数算法竞赛模板"><meta name=twitter:description content="算法竞赛中线性代数基础应用的代码实现模板"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"📖 文章","item":"https://liuyilong.com/p/"},{"@type":"ListItem","position":3,"name":"线性代数算法竞赛模板","item":"https://liuyilong.com/p/tech/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B%E6%A8%A1%E6%9D%BF/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"线性代数算法竞赛模板","name":"线性代数算法竞赛模板","description":"算法竞赛中线性代数基础应用的代码实现模板","keywords":[""],"articleBody":"一、矩阵 1. 矩阵乘法 1行3列 * 3行3列 = 1行3列, 最终答案覆盖f[ ]数组 void mul(int f[3], int a[3][3]) { int c[3]; memset(c, 0, sizeof(c)); for (int j = 0; j \u003c 3; j++) for (int k = 0; k \u003c 3; k++) c[j] = (c[j] + (ll)f[k] * a[k][j] % mod) % mod; memcpy(f, c, sizeof(c)); } 3行3列 * 3行3列 = 3行3列, 最终答案覆盖a[ ][ ]数组 void mulself(int a[3][3], int b[3][3]) { int c[3][3]; memset(c, 0, sizeof(c)); for (int i = 0; i \u003c 3; i++) for (int j = 0; j \u003c 3; j++) for (int k = 0; k \u003c 3; k++) c[i][j] = (c[i][j] + (ll)a[i][k] * b[k][j] % mod) % mod; memcpy(a, c, sizeof(c)); } 2. 矩阵求逆 求一个 n 阶矩阵的逆矩阵，对 $10^9+7$（质数）取模\n输入：\n第一行有一个整数 n，代表矩阵的大小；\n接下来 n行， 每行 n 个整数，其中第 i 行第 j 列的数代表矩阵中的元素 $a_{ij}$。\n输出:\n若矩阵可逆，则输出 n 行，每行 n 个整数，其中第 i 行第 j 列的数代表逆矩阵中的元素 $b_{ij}$，答案对 $10^9+7$ 取模；\n否则只输出一行 No Solution。\n/*************************************************************** *矩阵从1开始 ***************************************************************/ #include #define int64 long long using namespace std; const int64 mod=1e9+7; int64 a[410][410]; int n,is[410],js[410]; void exgcd(int a,int b,int \u0026x,int \u0026y){ if(!b)return x=1,y=0,void(); exgcd(b,a%b,y,x);y-=x*(a/b); } int inv(int p){ int x,y;exgcd(p,mod,x,y); return (x+mod)%mod; } void inv(){ for(int k=1;k\u003c=n;k++){ for(int i=k;i\u003c=n;i++) // 1 for(int j=k;j\u003c=n;j++)if(a[i][j]){ is[k]=i,js[k]=j;break; } for(int i=1;i\u003c=n;i++) // 2 swap(a[k][i],a[is[k]][i]); for(int i=1;i\u003c=n;i++) swap(a[i][k],a[i][js[k]]); if(!a[k][k]){ puts(\"No Solution\"); exit(0); } a[k][k]=inv(a[k][k]); // 3 for(int j=1;j\u003c=n;j++)if(j!=k) // 4 (a[k][j]*=a[k][k])%=mod; for(int i=1;i\u003c=n;i++)if(i!=k) // 5 for(int j=1;j\u003c=n;j++)if(j!=k) (a[i][j]+=mod-a[i][k]*a[k][j]%mod)%=mod; for(int i=1;i\u003c=n;i++)if(i!=k) // 就是这里不同 a[i][k]=(mod-a[i][k]*a[k][k]%mod)%mod; } for(int k=n;k;k--){ // 6 for(int i=1;i\u003c=n;i++) swap(a[js[k]][i],a[k][i]); for(int i=1;i\u003c=n;i++) swap(a[i][is[k]],a[i][k]); } } int main(){ scanf(\"%d\",\u0026n); for(int i=1;i\u003c=n;i++) for(int j=1;j\u003c=n;j++) scanf(\"%lld\",a[i]+j); inv(); for(int i=1;i\u003c=n;i++) for(int j=1;j\u003c=n;j++) printf(\"%lld%c\",a[i][j],j==n?'\\n':' '); return 0; } /*************************************************************** *矩阵从0开始 ***************************************************************/ #include using namespace std; typedef long long ll; const ll mod = 1000000007; ll a[400][400]; int n, is[400], js[400]; ll qmi(ll a, ll b) { ll ans = 1; for (; b; b \u003e\u003e= 1) { if (b \u0026 1) ans = ans * a % mod; a = a * a % mod; } return ans; } ll inv(ll x) { return qmi(x, mod - 2); } void inv() { for (int k = 0; k \u003c n; k++) { for (int i = k, j; i \u003c n; i++) { for (j = k; j \u003c n \u0026\u0026 !a[i][j]; j++); is[k] = i, js[k] = j; } for (int i = 0; i \u003c n; i++) swap(a[k][i], a[is[k]][i]); for (int i = 0; i \u003c n; i++) swap(a[i][k], a[i][js[k]]); if (!a[k][k]) { puts(\"No Solution\"); exit(0); } a[k][k] = inv(a[k][k]); for (int j = 0; j \u003c n; j++) if (j != k) (a[k][j] *= a[k][k]) %= mod; for (int i = 0; i \u003c n; i++) if (i != k) { ll temp = a[i][k]; a[i][k] = 0; for(int j = 0; j \u003c n; ++j) (a[i][j] += mod - a[k][j] * temp % mod) %= mod; } } for (int k = n - 1; k \u003e= 0; k--) { for (int i = 0; i \u003c n; i++) swap(a[js[k]][i], a[k][i]); for (int i = 0; i \u003c n; i++) swap(a[i][is[k]],a[i][k]); } } int main() { scanf(\"%d\", \u0026n); for (int i = 0; i \u003c n; i++) for (int j = 0; j \u003c n; j++) scanf(\"%lld\", a[i] + j); inv(); for (int i = 0; i \u003c n; i++) for (int j = 0; j \u003c n; j++) printf(\"%lld%c\", a[i][j], j == n - 1 ? '\\n' : ' '); return 0; } 3. 高斯消元 $O(n^3)$ a [N] [N] 是增广矩阵, 唯一解返回0, 无穷解1, 无解-1\nint gauss() { int r, c; for (r = 0, c = 0; c \u003c n; c++) { int t = r; for (int i = r; i \u003c n; i++) if (fabs(a[i][c]) \u003e fabs(a[t][c])) t = i; if (fabs(a[t][c]) \u003c eps) continue; for (int i = c; i \u003c= n; i++) swap(a[t][i], a[r][i]); for (int i = n; i \u003e= c; i--) a[r][i] /= a[r][c]; for (int i = r + 1; i \u003c n; i++) if (fabs(a[i][c]) \u003e eps) for (int j = n; j \u003e= c; j--) a[i][j] -= a[r][j] * a[i][c]; r++; } // 至此 r 就是增广矩阵秩 if (r \u003c n) { for (int i = r; i \u003c n; i++) if (fabs(a[i][n]) \u003e eps) return -1; return 1; } // 唯一解化为简化阶梯型矩阵 // 只要保留第i行第i列的系数即可,所以从第i+1行开始一直消到第n行, // 因为只要结果,所以可以只消第i行第n+1列的数(b); a[n][n] = 0; // 新增 for (int i = n - 1; i \u003e= 0; i--) for (int j = i + 1; j \u003c n; j++) a[i][n] -= a[i][j] * a[j][n]; return 0; } 4. 高斯消元解异或方程组 int gauss() { int r, c; for (r = 0, c = 0; c \u003c n; c++) { int t = r; for (int i = r; i \u003c n; i++) if (a[i][c]) { t = i; break; } if (!a[t][c]) continue; for (int i = c; i \u003c= n; i++) swap(a[r][i], a[t][i]); for (int i = r + 1; i \u003c n; i++) if (a[i][c]) for (int j = n; j \u003e= c; j--) a[i][j] ^= a[r][j]; r++; } if (r \u003c n) { for (int i = r; i \u003c n; i++) if (a[i][n]) return -1; return 1; } a[n][n] = 0 // 新增 for (int i = n - 1; i \u003e= 0; i--) for (int j = i + 1; j \u003c= n; j++) a[i][n] ^= a[i][j] \u0026 a[j][n]; return 0; } 5. 高斯消元解异或方程组(bitset优化) $O(\\frac{n^3}{32})$ $bitset\u003c N \u003e a[N]$ 存增广矩阵\nint gauss() { int r, c; for (r = 0, c = 0; c \u003c n; c++) { int t = r; for (int i = r; i \u003c n; i++) if (a[i][c]) { t = i; break; } if (!a[t][c]) continue; swap(a[r], a[t]); for (int i = r + 1; i \u003c n; i++) if (a[i][c]) a[i] ^= a[r]; r++; } if (r \u003c n) { for (int i = r; i \u003c n; i++) if (a[i][n]) return -1; return 1; } a[n][n] = 0; // 新增 for (int i = n - 1; i \u003e= 0; i--) for (int j = i + 1; j \u003c= n; j++) a[i][n] = a[i][n] ^ a[i][j] \u0026 a[j][n]; return 0; } 6. 线性基 #include #define reg register using namespace std; typedef long long ll; const int MN=60; ll a[61],tmp[61]; bool flag; void ins(ll x) { for(reg int i=MN; ~i; i--) if(x\u0026(1ll\u003c\u003ci)) if(!a[i]) { a[i]=x; return; } else x^=a[i]; flag=true; } bool check(ll x) { for(reg int i=MN; ~i; i--) if(x\u0026(1ll\u003c\u003ci)) if(!a[i]) return false; else x^=a[i]; return true; } ll qmax(ll res=0) { for(reg int i=MN; ~i; i--) res=max(res,res^a[i]); return res; } ll qmin() { if(flag) return 0; for(reg int i=0; i\u003c=MN; i++) if(a[i]) return a[i]; } ll query(ll k) { reg ll res=0; reg int cnt=0; k-=flag; if(!k) return 0; for(reg int i=0; i\u003c=MN; i++) { for(int j=i-1; ~j; j--) if(a[i]\u0026(1ll\u003c\u003cj)) a[i]^=a[j]; if(a[i]) tmp[cnt++]=a[i]; } if(k\u003e=(1ll\u003c\u003ccnt)) return -1; for(reg int i=0; i\u003ccnt; i++) if(k\u0026(1ll\u003c\u003ci)) res^=tmp[i]; return res; } int main() { int n; ll x; scanf(\"%d\",\u0026n); for(int i=1; i\u003c=n; i++) scanf(\"%lld\",\u0026x),ins(x); printf(\"%lld\\n\",qmax()); return 0; } 二、行列式 1. 浮点数行列式求值 问题描述：\n给一个 $n$ 阶行列式，求 $|A|$。\n$1\\leq n\\leq 600$，$a$ 为浮点数。\n#include using namespace std; const double eps = 1e-8; double a[110][110]; int n; double gauss() { double res = 1; int r, c; for (r = 0, c = 0; c \u003c n; c++, r++) { int t = r; for (int i = r; i \u003c n; i++) if (fabs(a[i][c]) \u003e fabs(a[t][c])) t = i; if (fabs(a[t][c]) \u003c eps) return 0; for (int i = c; i \u003c n; i++) swap(a[t][i], a[r][i]); res *= -1; for(int i = r + 1; i \u003c n; i++) { double x = a[i][c] / a[r][c]; for(int j = 0; j \u003c n; j++) { a[i][j] -= a[r][j] * x; } } } for(int i = 0; i \u003c n; i++) res *= a[i][i]; return res; } int main() { scanf(\"%d\", \u0026n); for (int i = 0; i \u003c n; i++) for (int j = 0; j \u003c n; j++) scanf(\"%lf\", \u0026a[i][j]); printf(\"%f\\n\", gauss()); return 0; } 2. 整数行列式求值（取模） 问题描述：\n给一个 $n$ 阶行列式，求 $|A|$。结果对 $mod$ 取模。\n$1\\leq n\\leq 600$，$1\\leq a_{ij}\\leq10^9+7$，$1≤p≤10^9+7。$\n解答：\n直接高斯消元除法会产生浮点数，而且 $mod$ 任意给定，除法不一定有逆元。所有要用到辗转相除法消元，如下： $$ \\left| \\begin{array}{cccc} 10 \u0026 a_{12} \u0026 \\cdots \u0026a_{1n}\\\\ 4 \u0026 a_{22} \u0026 \\cdots \u0026a_{2n}\\\\ \\vdots \u0026 \\vdots \u0026 \\ddots \u0026\\vdots\\\\ a_{n1} \u0026 a_{n2} \u0026 \\cdots \u0026a_{nn} \\end{array} \\right| $$ 只考虑 $\\left| \\begin{array}{cccc} 10\\\\ 4 \\end{array} \\right|$ 这部分。\n首先交换两个位置 $\\left| \\begin{array}{cccc} 4\\\\ 10 \\end{array} \\right|$，然后 $10\\%=4$ 得到 $\\left| \\begin{array}{cccc} 4\\\\ 2 \\end{array} \\right|$。\n再交换两个位置 $\\left| \\begin{array}{cccc} 2\\\\ 4 \\end{array} \\right|$，然后 $4\\%=2$ 得到 $\\left| \\begin{array}{cccc} 2\\\\ 0 \\end{array} \\right|$。\n这个代码对于 $a_{ij}$ 为 0 或者这个范围的负数应该也是适用的。\n复杂度：\n$O(n^2logn+n^3)$\n#include using namespace std; typedef long long ll; const int N = 610; int n, mod, a[N][N]; int gauss() { int res = 1; for (int i = 0; i \u003c n; i++) { for (int j = i + 1; j \u003c n; j++) { while (a[i][i]) { int x = a[j][i] / a[i][i]; for (int k = i; k \u003c n; k++) a[j][k] = (a[j][k] - (ll)a[i][k] * x % mod) % mod; swap(a[j], a[i]), res *= -1; } swap(a[j], a[i]), res *= -1; } } for (int i = 0; i \u003c n; i++) res = (ll)res * a[i][i] % mod; return (res + mod) % mod; } int main() { scanf(\"%d%d\", \u0026n, \u0026mod); for (int i = 0; i \u003c n; i++) for (int j = 0; j \u003c n; j++) scanf(\"%d\", \u0026a[i][j]); printf(\"%d\\n\", gauss()); return 0; } ","wordCount":"2113","inLanguage":"zh","datePublished":"2023-03-28T04:21:30+08:00","dateModified":"2023-03-28T04:21:30+08:00","author":{"@type":"Person","name":"liuyl"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://liuyilong.com/p/tech/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B%E6%A8%A1%E6%9D%BF/"},"publisher":{"@type":"Organization","name":"liuyl's blog","logo":{"@type":"ImageObject","url":"https://liuyilong.com/avatar.jpg"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://liuyilong.com accesskey=h title="liuyl's blog (Alt + H)"><img src=https://liuyilong.com/avatar.jpg alt aria-label=logo height=35>liuyl's blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://liuyilong.com/ title=主页><span>主页</span></a></li><li><a href=https://liuyilong.com/tags/ title=标签><span>标签</span></a></li><li><a href=https://liuyilong.com/archives/ title=时间轴><span>时间轴</span></a></li><li><a href=https://liuyilong.com/search/ title="搜索 (Alt + /)" accesskey=/><span>搜索</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://liuyilong.com>主页</a>&nbsp;»&nbsp;<a href=https://liuyilong.com/p/>📖 文章</a></div><h1 class=post-title>线性代数算法竞赛模板</h1><div class=post-meta><style>i[id*=post_meta_style]{display:flex;align-items:center;margin:0 0 10px}.parent-post-meta{display:flex;flex-wrap:wrap;opacity:.8}</style><span class=parent-post-meta><span id=post_meta_style_1><span class="fa fa-calendar-check-o"></span>
<span>2023-03-28
&nbsp;&nbsp;</span></span>
<span id=post_meta_style_2><span class="fa fa-file-word-o"></span>
<span>2113字
&nbsp;&nbsp;</span></span>
<span id=post_meta_style_3><span class="fa fa-clock-o"></span>
<span>5分钟
&nbsp;&nbsp;</span></span>
<span id=post_meta_style_4><span class="fa fa-user-o"></span>
<span>liuyl
&nbsp;&nbsp;</span></span>
<span id=post_meta_style_5><span class="fa fa-tags" style=opacity:.8></span>
<span><span class=post-tags-meta></span></span></span></span></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>目录</span></summary><div class=inner><ul><li><a href=#%e4%b8%80%e7%9f%a9%e9%98%b5 aria-label=一、矩阵>一、矩阵</a><ul><li><a href=#1-%e7%9f%a9%e9%98%b5%e4%b9%98%e6%b3%95 aria-label="1. 矩阵乘法">1. 矩阵乘法</a></li><li><a href=#2-%e7%9f%a9%e9%98%b5%e6%b1%82%e9%80%86 aria-label="2. 矩阵求逆">2. 矩阵求逆</a></li><li><a href=#3-%e9%ab%98%e6%96%af%e6%b6%88%e5%85%83-on3 aria-label="3. 高斯消元 $O(n^3)$">3. 高斯消元 $O(n^3)$</a></li><li><a href=#4-%e9%ab%98%e6%96%af%e6%b6%88%e5%85%83%e8%a7%a3%e5%bc%82%e6%88%96%e6%96%b9%e7%a8%8b%e7%bb%84 aria-label="4. 高斯消元解异或方程组">4. 高斯消元解异或方程组</a></li><li><a href=#5-%e9%ab%98%e6%96%af%e6%b6%88%e5%85%83%e8%a7%a3%e5%bc%82%e6%88%96%e6%96%b9%e7%a8%8b%e7%bb%84bitset%e4%bc%98%e5%8c%96-ofracn332 aria-label="5. 高斯消元解异或方程组(bitset优化) $O(\frac{n^3}{32})$">5. 高斯消元解异或方程组(bitset优化) $O(\frac{n^3}{32})$</a></li><li><a href=#6-%e7%ba%bf%e6%80%a7%e5%9f%ba aria-label="6. 线性基">6. 线性基</a></li></ul></li><li><a href=#%e4%ba%8c%e8%a1%8c%e5%88%97%e5%bc%8f aria-label=二、行列式>二、行列式</a><ul><li><a href=#1-%e6%b5%ae%e7%82%b9%e6%95%b0%e8%a1%8c%e5%88%97%e5%bc%8f%e6%b1%82%e5%80%bc aria-label="1. 浮点数行列式求值">1. 浮点数行列式求值</a></li><li><a href=#2-%e6%95%b4%e6%95%b0%e8%a1%8c%e5%88%97%e5%bc%8f%e6%b1%82%e5%80%bc%e5%8f%96%e6%a8%a1 aria-label="2. 整数行列式求值（取模）">2. 整数行列式求值（取模）</a></li></ul></li></ul></div></details></div><div class=post-content><h2 id=一矩阵>一、矩阵<a hidden class=anchor aria-hidden=true href=#一矩阵>#</a></h2><h3 id=1-矩阵乘法>1. 矩阵乘法<a hidden class=anchor aria-hidden=true href=#1-矩阵乘法>#</a></h3><ul><li>1行3列 * 3行3列 = 1行3列, 最终答案覆盖f[ ]数组</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-c++ data-lang=c++><span class=line><span class=cl><span class=kt>void</span> <span class=nf>mul</span><span class=p>(</span><span class=kt>int</span> <span class=n>f</span><span class=p>[</span><span class=mi>3</span><span class=p>],</span> <span class=kt>int</span> <span class=n>a</span><span class=p>[</span><span class=mi>3</span><span class=p>][</span><span class=mi>3</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>c</span><span class=p>[</span><span class=mi>3</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=n>memset</span><span class=p>(</span><span class=n>c</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=k>sizeof</span><span class=p>(</span><span class=n>c</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=mi>3</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=mi>3</span><span class=p>;</span> <span class=n>k</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>c</span><span class=p>[</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>c</span><span class=p>[</span><span class=n>j</span><span class=p>]</span> <span class=o>+</span> <span class=p>(</span><span class=n>ll</span><span class=p>)</span><span class=n>f</span><span class=p>[</span><span class=n>k</span><span class=p>]</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=n>k</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>%</span> <span class=n>mod</span><span class=p>)</span> <span class=o>%</span> <span class=n>mod</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>memcpy</span><span class=p>(</span><span class=n>f</span><span class=p>,</span> <span class=n>c</span><span class=p>,</span> <span class=k>sizeof</span><span class=p>(</span><span class=n>c</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><ul><li>3行3列 * 3行3列 = 3行3列, 最终答案覆盖a[ ][ ]数组</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-c++ data-lang=c++><span class=line><span class=cl><span class=kt>void</span> <span class=nf>mulself</span><span class=p>(</span><span class=kt>int</span> <span class=n>a</span><span class=p>[</span><span class=mi>3</span><span class=p>][</span><span class=mi>3</span><span class=p>],</span> <span class=kt>int</span> <span class=n>b</span><span class=p>[</span><span class=mi>3</span><span class=p>][</span><span class=mi>3</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>c</span><span class=p>[</span><span class=mi>3</span><span class=p>][</span><span class=mi>3</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=n>memset</span><span class=p>(</span><span class=n>c</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=k>sizeof</span><span class=p>(</span><span class=n>c</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>3</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=mi>3</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=mi>3</span><span class=p>;</span> <span class=n>k</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>c</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>c</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>+</span> <span class=p>(</span><span class=n>ll</span><span class=p>)</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>k</span><span class=p>]</span> <span class=o>*</span> <span class=n>b</span><span class=p>[</span><span class=n>k</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>%</span> <span class=n>mod</span><span class=p>)</span> <span class=o>%</span> <span class=n>mod</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>memcpy</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>c</span><span class=p>,</span> <span class=k>sizeof</span><span class=p>(</span><span class=n>c</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=2-矩阵求逆>2. 矩阵求逆<a hidden class=anchor aria-hidden=true href=#2-矩阵求逆>#</a></h3><p>求一个 n 阶矩阵的逆矩阵，对 $10^9+7$（质数）取模</p><ul><li><p>输入：</p><p>第一行有一个整数 n，代表矩阵的大小；</p><p>接下来 n行， 每行 n 个整数，其中第 i 行第 j 列的数代表矩阵中的元素 $a_{ij}$。</p></li><li><p>输出:</p><p>若矩阵可逆，则输出 n 行，每行 n 个整数，其中第 i 行第 j 列的数代表逆矩阵中的元素 $b_{ij}$，答案对 $10^9+7$ 取模；</p><p>否则只输出一行 <code>No Solution</code>。</p></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-c++ data-lang=c++><span class=line><span class=cl><span class=cm>/***************************************************************
</span></span></span><span class=line><span class=cl><span class=cm>*矩阵从1开始
</span></span></span><span class=line><span class=cl><span class=cm>***************************************************************/</span>
</span></span><span class=line><span class=cl><span class=cp>#include</span><span class=cpf>&lt;bits/stdc++.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#define int64 long long
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=k>using</span> <span class=k>namespace</span> <span class=n>std</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=n>int64</span> <span class=n>mod</span><span class=o>=</span><span class=mf>1e9</span><span class=o>+</span><span class=mi>7</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>int64</span> <span class=n>a</span><span class=p>[</span><span class=mi>410</span><span class=p>][</span><span class=mi>410</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>n</span><span class=p>,</span><span class=n>is</span><span class=p>[</span><span class=mi>410</span><span class=p>],</span><span class=n>js</span><span class=p>[</span><span class=mi>410</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>exgcd</span><span class=p>(</span><span class=kt>int</span> <span class=n>a</span><span class=p>,</span><span class=kt>int</span> <span class=n>b</span><span class=p>,</span><span class=kt>int</span> <span class=o>&amp;</span><span class=n>x</span><span class=p>,</span><span class=kt>int</span> <span class=o>&amp;</span><span class=n>y</span><span class=p>){</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=p>(</span><span class=o>!</span><span class=n>b</span><span class=p>)</span><span class=k>return</span> <span class=n>x</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span><span class=n>y</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span><span class=kt>void</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=n>exgcd</span><span class=p>(</span><span class=n>b</span><span class=p>,</span><span class=n>a</span><span class=o>%</span><span class=n>b</span><span class=p>,</span><span class=n>y</span><span class=p>,</span><span class=n>x</span><span class=p>);</span><span class=n>y</span><span class=o>-=</span><span class=n>x</span><span class=o>*</span><span class=p>(</span><span class=n>a</span><span class=o>/</span><span class=n>b</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>inv</span><span class=p>(</span><span class=kt>int</span> <span class=n>p</span><span class=p>){</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>;</span><span class=n>exgcd</span><span class=p>(</span><span class=n>p</span><span class=p>,</span><span class=n>mod</span><span class=p>,</span><span class=n>x</span><span class=p>,</span><span class=n>y</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>(</span><span class=n>x</span><span class=o>+</span><span class=n>mod</span><span class=p>)</span><span class=o>%</span><span class=n>mod</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>inv</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>k</span><span class=o>=</span><span class=mi>1</span><span class=p>;</span><span class=n>k</span><span class=o>&lt;=</span><span class=n>n</span><span class=p>;</span><span class=n>k</span><span class=o>++</span><span class=p>){</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span><span class=o>=</span><span class=n>k</span><span class=p>;</span><span class=n>i</span><span class=o>&lt;=</span><span class=n>n</span><span class=p>;</span><span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=c1>// 1
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>j</span><span class=o>=</span><span class=n>k</span><span class=p>;</span><span class=n>j</span><span class=o>&lt;=</span><span class=n>n</span><span class=p>;</span><span class=n>j</span><span class=o>++</span><span class=p>)</span><span class=k>if</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]){</span>
</span></span><span class=line><span class=cl>                <span class=n>is</span><span class=p>[</span><span class=n>k</span><span class=p>]</span><span class=o>=</span><span class=n>i</span><span class=p>,</span><span class=n>js</span><span class=p>[</span><span class=n>k</span><span class=p>]</span><span class=o>=</span><span class=n>j</span><span class=p>;</span><span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span><span class=o>=</span><span class=mi>1</span><span class=p>;</span><span class=n>i</span><span class=o>&lt;=</span><span class=n>n</span><span class=p>;</span><span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=c1>// 2
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=n>swap</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>k</span><span class=p>][</span><span class=n>i</span><span class=p>],</span><span class=n>a</span><span class=p>[</span><span class=n>is</span><span class=p>[</span><span class=n>k</span><span class=p>]][</span><span class=n>i</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span><span class=o>=</span><span class=mi>1</span><span class=p>;</span><span class=n>i</span><span class=o>&lt;=</span><span class=n>n</span><span class=p>;</span><span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>swap</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>k</span><span class=p>],</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>js</span><span class=p>[</span><span class=n>k</span><span class=p>]]);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=o>!</span><span class=n>a</span><span class=p>[</span><span class=n>k</span><span class=p>][</span><span class=n>k</span><span class=p>]){</span>
</span></span><span class=line><span class=cl>            <span class=n>puts</span><span class=p>(</span><span class=s>&#34;No Solution&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>exit</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>a</span><span class=p>[</span><span class=n>k</span><span class=p>][</span><span class=n>k</span><span class=p>]</span><span class=o>=</span><span class=n>inv</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>k</span><span class=p>][</span><span class=n>k</span><span class=p>]);</span> <span class=c1>// 3
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>j</span><span class=o>=</span><span class=mi>1</span><span class=p>;</span><span class=n>j</span><span class=o>&lt;=</span><span class=n>n</span><span class=p>;</span><span class=n>j</span><span class=o>++</span><span class=p>)</span><span class=k>if</span><span class=p>(</span><span class=n>j</span><span class=o>!=</span><span class=n>k</span><span class=p>)</span> <span class=c1>// 4
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>k</span><span class=p>][</span><span class=n>j</span><span class=p>]</span><span class=o>*=</span><span class=n>a</span><span class=p>[</span><span class=n>k</span><span class=p>][</span><span class=n>k</span><span class=p>])</span><span class=o>%=</span><span class=n>mod</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span><span class=o>=</span><span class=mi>1</span><span class=p>;</span><span class=n>i</span><span class=o>&lt;=</span><span class=n>n</span><span class=p>;</span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=k>if</span><span class=p>(</span><span class=n>i</span><span class=o>!=</span><span class=n>k</span><span class=p>)</span> <span class=c1>// 5
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>j</span><span class=o>=</span><span class=mi>1</span><span class=p>;</span><span class=n>j</span><span class=o>&lt;=</span><span class=n>n</span><span class=p>;</span><span class=n>j</span><span class=o>++</span><span class=p>)</span><span class=k>if</span><span class=p>(</span><span class=n>j</span><span class=o>!=</span><span class=n>k</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span><span class=o>+=</span><span class=n>mod</span><span class=o>-</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>k</span><span class=p>]</span><span class=o>*</span><span class=n>a</span><span class=p>[</span><span class=n>k</span><span class=p>][</span><span class=n>j</span><span class=p>]</span><span class=o>%</span><span class=n>mod</span><span class=p>)</span><span class=o>%=</span><span class=n>mod</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span><span class=o>=</span><span class=mi>1</span><span class=p>;</span><span class=n>i</span><span class=o>&lt;=</span><span class=n>n</span><span class=p>;</span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=k>if</span><span class=p>(</span><span class=n>i</span><span class=o>!=</span><span class=n>k</span><span class=p>)</span> <span class=c1>// 就是这里不同
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>k</span><span class=p>]</span><span class=o>=</span><span class=p>(</span><span class=n>mod</span><span class=o>-</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>k</span><span class=p>]</span><span class=o>*</span><span class=n>a</span><span class=p>[</span><span class=n>k</span><span class=p>][</span><span class=n>k</span><span class=p>]</span><span class=o>%</span><span class=n>mod</span><span class=p>)</span><span class=o>%</span><span class=n>mod</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>k</span><span class=o>=</span><span class=n>n</span><span class=p>;</span><span class=n>k</span><span class=p>;</span><span class=n>k</span><span class=o>--</span><span class=p>){</span> <span class=c1>// 6
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span><span class=o>=</span><span class=mi>1</span><span class=p>;</span><span class=n>i</span><span class=o>&lt;=</span><span class=n>n</span><span class=p>;</span><span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>swap</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>js</span><span class=p>[</span><span class=n>k</span><span class=p>]][</span><span class=n>i</span><span class=p>],</span><span class=n>a</span><span class=p>[</span><span class=n>k</span><span class=p>][</span><span class=n>i</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span><span class=o>=</span><span class=mi>1</span><span class=p>;</span><span class=n>i</span><span class=o>&lt;=</span><span class=n>n</span><span class=p>;</span><span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>swap</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>is</span><span class=p>[</span><span class=n>k</span><span class=p>]],</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>k</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>    <span class=n>scanf</span><span class=p>(</span><span class=s>&#34;%d&#34;</span><span class=p>,</span><span class=o>&amp;</span><span class=n>n</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span><span class=o>=</span><span class=mi>1</span><span class=p>;</span><span class=n>i</span><span class=o>&lt;=</span><span class=n>n</span><span class=p>;</span><span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>j</span><span class=o>=</span><span class=mi>1</span><span class=p>;</span><span class=n>j</span><span class=o>&lt;=</span><span class=n>n</span><span class=p>;</span><span class=n>j</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>scanf</span><span class=p>(</span><span class=s>&#34;%lld&#34;</span><span class=p>,</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>+</span><span class=n>j</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>inv</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span><span class=o>=</span><span class=mi>1</span><span class=p>;</span><span class=n>i</span><span class=o>&lt;=</span><span class=n>n</span><span class=p>;</span><span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>j</span><span class=o>=</span><span class=mi>1</span><span class=p>;</span><span class=n>j</span><span class=o>&lt;=</span><span class=n>n</span><span class=p>;</span><span class=n>j</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>printf</span><span class=p>(</span><span class=s>&#34;%lld%c&#34;</span><span class=p>,</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>],</span><span class=n>j</span><span class=o>==</span><span class=n>n</span><span class=o>?</span><span class=sc>&#39;\n&#39;</span><span class=o>:</span><span class=sc>&#39; &#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/***************************************************************
</span></span></span><span class=line><span class=cl><span class=cm>*矩阵从0开始
</span></span></span><span class=line><span class=cl><span class=cm>***************************************************************/</span>
</span></span><span class=line><span class=cl><span class=cp>#include</span><span class=cpf>&lt;bits/stdc++.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=k>using</span> <span class=k>namespace</span> <span class=n>std</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>typedef</span> <span class=kt>long</span> <span class=kt>long</span> <span class=n>ll</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=n>ll</span> <span class=n>mod</span> <span class=o>=</span> <span class=mi>1000000007</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ll</span> <span class=n>a</span><span class=p>[</span><span class=mi>400</span><span class=p>][</span><span class=mi>400</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>n</span><span class=p>,</span> <span class=n>is</span><span class=p>[</span><span class=mi>400</span><span class=p>],</span> <span class=n>js</span><span class=p>[</span><span class=mi>400</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ll</span> <span class=nf>qmi</span><span class=p>(</span><span class=n>ll</span> <span class=n>a</span><span class=p>,</span> <span class=n>ll</span> <span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>ll</span> <span class=n>ans</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(;</span> <span class=n>b</span><span class=p>;</span> <span class=n>b</span> <span class=o>&gt;&gt;=</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>b</span> <span class=o>&amp;</span> <span class=mi>1</span><span class=p>)</span> <span class=n>ans</span> <span class=o>=</span> <span class=n>ans</span> <span class=o>*</span> <span class=n>a</span> <span class=o>%</span> <span class=n>mod</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>a</span> <span class=o>=</span> <span class=n>a</span> <span class=o>*</span> <span class=n>a</span> <span class=o>%</span> <span class=n>mod</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>ans</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ll</span> <span class=nf>inv</span><span class=p>(</span><span class=n>ll</span> <span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>qmi</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>mod</span> <span class=o>-</span> <span class=mi>2</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>inv</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>k</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>k</span><span class=p>,</span> <span class=n>j</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=p>(</span><span class=n>j</span> <span class=o>=</span> <span class=n>k</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>];</span> <span class=n>j</span><span class=o>++</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>is</span><span class=p>[</span><span class=n>k</span><span class=p>]</span> <span class=o>=</span> <span class=n>i</span><span class=p>,</span> <span class=n>js</span><span class=p>[</span><span class=n>k</span><span class=p>]</span> <span class=o>=</span> <span class=n>j</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>swap</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>k</span><span class=p>][</span><span class=n>i</span><span class=p>],</span> <span class=n>a</span><span class=p>[</span><span class=n>is</span><span class=p>[</span><span class=n>k</span><span class=p>]][</span><span class=n>i</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>swap</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>k</span><span class=p>],</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>js</span><span class=p>[</span><span class=n>k</span><span class=p>]]);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>a</span><span class=p>[</span><span class=n>k</span><span class=p>][</span><span class=n>k</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>puts</span><span class=p>(</span><span class=s>&#34;No Solution&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>exit</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>a</span><span class=p>[</span><span class=n>k</span><span class=p>][</span><span class=n>k</span><span class=p>]</span> <span class=o>=</span> <span class=n>inv</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>k</span><span class=p>][</span><span class=n>k</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>j</span> <span class=o>!=</span> <span class=n>k</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>k</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>*=</span> <span class=n>a</span><span class=p>[</span><span class=n>k</span><span class=p>][</span><span class=n>k</span><span class=p>])</span> <span class=o>%=</span> <span class=n>mod</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>i</span> <span class=o>!=</span> <span class=n>k</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>ll</span> <span class=n>temp</span> <span class=o>=</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>k</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>k</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>j</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>+=</span> <span class=n>mod</span> <span class=o>-</span> <span class=n>a</span><span class=p>[</span><span class=n>k</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>*</span> <span class=n>temp</span> <span class=o>%</span> <span class=n>mod</span><span class=p>)</span> <span class=o>%=</span> <span class=n>mod</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span> <span class=n>k</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span><span class=o>--</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>swap</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>js</span><span class=p>[</span><span class=n>k</span><span class=p>]][</span><span class=n>i</span><span class=p>],</span> <span class=n>a</span><span class=p>[</span><span class=n>k</span><span class=p>][</span><span class=n>i</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>swap</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>is</span><span class=p>[</span><span class=n>k</span><span class=p>]],</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>k</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>scanf</span><span class=p>(</span><span class=s>&#34;%d&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>n</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>scanf</span><span class=p>(</span><span class=s>&#34;%lld&#34;</span><span class=p>,</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>+</span> <span class=n>j</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>inv</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>printf</span><span class=p>(</span><span class=s>&#34;%lld%c&#34;</span><span class=p>,</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>],</span> <span class=n>j</span> <span class=o>==</span> <span class=n>n</span> <span class=o>-</span> <span class=mi>1</span> <span class=o>?</span> <span class=sc>&#39;\n&#39;</span> <span class=o>:</span> <span class=sc>&#39; &#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=3-高斯消元-on3>3. 高斯消元 $O(n^3)$<a hidden class=anchor aria-hidden=true href=#3-高斯消元-on3>#</a></h3><p>a [N] [N] 是增广矩阵, 唯一解返回0, 无穷解1, 无解-1</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c++ data-lang=c++><span class=line><span class=cl><span class=kt>int</span> <span class=nf>gauss</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>r</span><span class=p>,</span> <span class=n>c</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=n>r</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>c</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>c</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>c</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>t</span> <span class=o>=</span> <span class=n>r</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>r</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>fabs</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>c</span><span class=p>])</span> <span class=o>&gt;</span> <span class=n>fabs</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>c</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>                <span class=n>t</span> <span class=o>=</span> <span class=n>i</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>fabs</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>c</span><span class=p>])</span> <span class=o>&lt;</span> <span class=n>eps</span><span class=p>)</span> <span class=k>continue</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>c</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=n>swap</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>i</span><span class=p>],</span> <span class=n>a</span><span class=p>[</span><span class=n>r</span><span class=p>][</span><span class=n>i</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span> <span class=o>&gt;=</span> <span class=n>c</span><span class=p>;</span> <span class=n>i</span><span class=o>--</span><span class=p>)</span> <span class=n>a</span><span class=p>[</span><span class=n>r</span><span class=p>][</span><span class=n>i</span><span class=p>]</span> <span class=o>/=</span> <span class=n>a</span><span class=p>[</span><span class=n>r</span><span class=p>][</span><span class=n>c</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>r</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>fabs</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>c</span><span class=p>])</span> <span class=o>&gt;</span> <span class=n>eps</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span> <span class=o>&gt;=</span> <span class=n>c</span><span class=p>;</span> <span class=n>j</span><span class=o>--</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>-=</span> <span class=n>a</span><span class=p>[</span><span class=n>r</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>c</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>        <span class=n>r</span><span class=o>++</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 至此 r 就是增广矩阵秩
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=n>r</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>r</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>fabs</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>n</span><span class=p>])</span> <span class=o>&gt;</span> <span class=n>eps</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 唯一解化为简化阶梯型矩阵
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 只要保留第i行第i列的系数即可,所以从第i+1行开始一直消到第n行,
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 因为只要结果,所以可以只消第i行第n+1列的数(b);
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>a</span><span class=p>[</span><span class=n>n</span><span class=p>][</span><span class=n>n</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>  <span class=c1>// 新增
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span><span class=o>--</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>n</span><span class=p>]</span> <span class=o>-=</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=n>j</span><span class=p>][</span><span class=n>n</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=4-高斯消元解异或方程组>4. 高斯消元解异或方程组<a hidden class=anchor aria-hidden=true href=#4-高斯消元解异或方程组>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-c++ data-lang=c++><span class=line><span class=cl><span class=kt>int</span> <span class=nf>gauss</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>r</span><span class=p>,</span> <span class=n>c</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=n>r</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>c</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>c</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>c</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>t</span> <span class=o>=</span> <span class=n>r</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>r</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>c</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>t</span> <span class=o>=</span> <span class=n>i</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>a</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>c</span><span class=p>])</span> <span class=k>continue</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>c</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=n>swap</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>r</span><span class=p>][</span><span class=n>i</span><span class=p>],</span> <span class=n>a</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>i</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>r</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>c</span><span class=p>])</span>
</span></span><span class=line><span class=cl>                <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span> <span class=o>&gt;=</span> <span class=n>c</span><span class=p>;</span> <span class=n>j</span><span class=o>--</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>^=</span> <span class=n>a</span><span class=p>[</span><span class=n>r</span><span class=p>][</span><span class=n>j</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                    
</span></span><span class=line><span class=cl>        <span class=n>r</span><span class=o>++</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>r</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>r</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>n</span><span class=p>])</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>a</span><span class=p>[</span><span class=n>n</span><span class=p>][</span><span class=n>n</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span> <span class=c1>// 新增
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span><span class=o>--</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;=</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>n</span><span class=p>]</span> <span class=o>^=</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>&amp;</span> <span class=n>a</span><span class=p>[</span><span class=n>j</span><span class=p>][</span><span class=n>n</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=5-高斯消元解异或方程组bitset优化-ofracn332>5. 高斯消元解异或方程组(bitset优化) $O(\frac{n^3}{32})$<a hidden class=anchor aria-hidden=true href=#5-高斯消元解异或方程组bitset优化-ofracn332>#</a></h3><p>$bitset&lt; N > a[N]$ 存增广矩阵</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c++ data-lang=c++><span class=line><span class=cl><span class=kt>int</span> <span class=nf>gauss</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>r</span><span class=p>,</span> <span class=n>c</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=n>r</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>c</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>c</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>c</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>t</span> <span class=o>=</span> <span class=n>r</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>r</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>c</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>t</span> <span class=o>=</span> <span class=n>i</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>a</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>c</span><span class=p>])</span> <span class=k>continue</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>swap</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>r</span><span class=p>],</span> <span class=n>a</span><span class=p>[</span><span class=n>t</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>r</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>c</span><span class=p>])</span>
</span></span><span class=line><span class=cl>                <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>^=</span> <span class=n>a</span><span class=p>[</span><span class=n>r</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                    
</span></span><span class=line><span class=cl>        <span class=n>r</span><span class=o>++</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>r</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>r</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>n</span><span class=p>])</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>a</span><span class=p>[</span><span class=n>n</span><span class=p>][</span><span class=n>n</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>  <span class=c1>// 新增
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span><span class=o>--</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;=</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>n</span><span class=p>]</span> <span class=o>=</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>n</span><span class=p>]</span> <span class=o>^</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>&amp;</span> <span class=n>a</span><span class=p>[</span><span class=n>j</span><span class=p>][</span><span class=n>n</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=6-线性基>6. 线性基<a hidden class=anchor aria-hidden=true href=#6-线性基>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-c++ data-lang=c++><span class=line><span class=cl><span class=cp>#include</span><span class=cpf>&lt;bits/stdc++.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#define reg register
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=k>using</span> <span class=k>namespace</span> <span class=n>std</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>typedef</span> <span class=kt>long</span> <span class=kt>long</span> <span class=n>ll</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=kt>int</span> <span class=n>MN</span><span class=o>=</span><span class=mi>60</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>ll</span> <span class=n>a</span><span class=p>[</span><span class=mi>61</span><span class=p>],</span><span class=n>tmp</span><span class=p>[</span><span class=mi>61</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=kt>bool</span> <span class=n>flag</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>ins</span><span class=p>(</span><span class=n>ll</span> <span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=p>(</span><span class=n>reg</span> <span class=kt>int</span> <span class=n>i</span><span class=o>=</span><span class=n>MN</span><span class=p>;</span> <span class=o>~</span><span class=n>i</span><span class=p>;</span> <span class=n>i</span><span class=o>--</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=n>x</span><span class=o>&amp;</span><span class=p>(</span><span class=mi>1ll</span><span class=o>&lt;&lt;</span><span class=n>i</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span><span class=p>(</span><span class=o>!</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>=</span><span class=n>x</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span>
</span></span><span class=line><span class=cl>                <span class=n>x</span><span class=o>^=</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span><span class=o>=</span><span class=nb>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kt>bool</span> <span class=nf>check</span><span class=p>(</span><span class=n>ll</span> <span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=p>(</span><span class=n>reg</span> <span class=kt>int</span> <span class=n>i</span><span class=o>=</span><span class=n>MN</span><span class=p>;</span> <span class=o>~</span><span class=n>i</span><span class=p>;</span> <span class=n>i</span><span class=o>--</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=n>x</span><span class=o>&amp;</span><span class=p>(</span><span class=mi>1ll</span><span class=o>&lt;&lt;</span><span class=n>i</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span><span class=p>(</span><span class=o>!</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=nb>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span>
</span></span><span class=line><span class=cl>                <span class=n>x</span><span class=o>^=</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>ll</span> <span class=nf>qmax</span><span class=p>(</span><span class=n>ll</span> <span class=n>res</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=p>(</span><span class=n>reg</span> <span class=kt>int</span> <span class=n>i</span><span class=o>=</span><span class=n>MN</span><span class=p>;</span> <span class=o>~</span><span class=n>i</span><span class=p>;</span> <span class=n>i</span><span class=o>--</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>res</span><span class=o>=</span><span class=n>max</span><span class=p>(</span><span class=n>res</span><span class=p>,</span><span class=n>res</span><span class=o>^</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>ll</span> <span class=nf>qmin</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=p>(</span><span class=n>flag</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=p>(</span><span class=n>reg</span> <span class=kt>int</span> <span class=n>i</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span> <span class=n>i</span><span class=o>&lt;=</span><span class=n>MN</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>ll</span> <span class=nf>query</span><span class=p>(</span><span class=n>ll</span> <span class=n>k</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>reg</span> <span class=n>ll</span> <span class=n>res</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>reg</span> <span class=kt>int</span> <span class=n>cnt</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>k</span><span class=o>-=</span><span class=n>flag</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=p>(</span><span class=o>!</span><span class=n>k</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=p>(</span><span class=n>reg</span> <span class=kt>int</span> <span class=n>i</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span> <span class=n>i</span><span class=o>&lt;=</span><span class=n>MN</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>j</span><span class=o>=</span><span class=n>i</span><span class=o>-</span><span class=mi>1</span><span class=p>;</span> <span class=o>~</span><span class=n>j</span><span class=p>;</span> <span class=n>j</span><span class=o>--</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>&amp;</span><span class=p>(</span><span class=mi>1ll</span><span class=o>&lt;&lt;</span><span class=n>j</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>^=</span><span class=n>a</span><span class=p>[</span><span class=n>j</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            <span class=n>tmp</span><span class=p>[</span><span class=n>cnt</span><span class=o>++</span><span class=p>]</span><span class=o>=</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=p>(</span><span class=n>k</span><span class=o>&gt;=</span><span class=p>(</span><span class=mi>1ll</span><span class=o>&lt;&lt;</span><span class=n>cnt</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=p>(</span><span class=n>reg</span> <span class=kt>int</span> <span class=n>i</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span> <span class=n>i</span><span class=o>&lt;</span><span class=n>cnt</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=n>k</span><span class=o>&amp;</span><span class=p>(</span><span class=mi>1ll</span><span class=o>&lt;&lt;</span><span class=n>i</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=n>res</span><span class=o>^=</span><span class=n>tmp</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>res</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>n</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>ll</span> <span class=n>x</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>scanf</span><span class=p>(</span><span class=s>&#34;%d&#34;</span><span class=p>,</span><span class=o>&amp;</span><span class=n>n</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span><span class=o>=</span><span class=mi>1</span><span class=p>;</span> <span class=n>i</span><span class=o>&lt;=</span><span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>scanf</span><span class=p>(</span><span class=s>&#34;%lld&#34;</span><span class=p>,</span><span class=o>&amp;</span><span class=n>x</span><span class=p>),</span><span class=n>ins</span><span class=p>(</span><span class=n>x</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>printf</span><span class=p>(</span><span class=s>&#34;%lld</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span><span class=n>qmax</span><span class=p>());</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h2 id=二行列式>二、行列式<a hidden class=anchor aria-hidden=true href=#二行列式>#</a></h2><h3 id=1-浮点数行列式求值>1. 浮点数行列式求值<a hidden class=anchor aria-hidden=true href=#1-浮点数行列式求值>#</a></h3><p>问题描述：</p><p>给一个 $n$ 阶行列式，求 $|A|$。</p><p>$1\leq n\leq 600$，$a$ 为浮点数。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c++ data-lang=c++><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;bits/stdc++.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=k>using</span> <span class=k>namespace</span> <span class=n>std</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=kt>double</span> <span class=n>eps</span> <span class=o>=</span> <span class=mf>1e-8</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>double</span> <span class=n>a</span><span class=p>[</span><span class=mi>110</span><span class=p>][</span><span class=mi>110</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>n</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>double</span> <span class=nf>gauss</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=kt>double</span> <span class=n>res</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>r</span><span class=p>,</span> <span class=n>c</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=k>for</span> <span class=p>(</span><span class=n>r</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>c</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>c</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>c</span><span class=o>++</span><span class=p>,</span> <span class=n>r</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>t</span> <span class=o>=</span> <span class=n>r</span><span class=p>;</span>
</span></span><span class=line><span class=cl>		<span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>r</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			<span class=k>if</span> <span class=p>(</span><span class=n>fabs</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>c</span><span class=p>])</span> <span class=o>&gt;</span> <span class=n>fabs</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>c</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>                <span class=n>t</span> <span class=o>=</span> <span class=n>i</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>		<span class=k>if</span> <span class=p>(</span><span class=n>fabs</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>c</span><span class=p>])</span> <span class=o>&lt;</span> <span class=n>eps</span><span class=p>)</span> <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>c</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=n>swap</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>i</span><span class=p>],</span> <span class=n>a</span><span class=p>[</span><span class=n>r</span><span class=p>][</span><span class=n>i</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>        <span class=n>res</span> <span class=o>*=</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>r</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=kt>double</span> <span class=n>x</span> <span class=o>=</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>c</span><span class=p>]</span> <span class=o>/</span> <span class=n>a</span><span class=p>[</span><span class=n>r</span><span class=p>][</span><span class=n>c</span><span class=p>];</span>
</span></span><span class=line><span class=cl>			<span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			<span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>-=</span> <span class=n>a</span><span class=p>[</span><span class=n>r</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>*</span> <span class=n>x</span><span class=p>;</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=n>res</span> <span class=o>*=</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=n>res</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>scanf</span><span class=p>(</span><span class=s>&#34;%d&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>n</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>scanf</span><span class=p>(</span><span class=s>&#34;%lf&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>printf</span><span class=p>(</span><span class=s>&#34;%f</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>gauss</span><span class=p>());</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=2-整数行列式求值取模>2. 整数行列式求值（取模）<a hidden class=anchor aria-hidden=true href=#2-整数行列式求值取模>#</a></h3><p>问题描述：</p><p>给一个 $n$ 阶行列式，求 $|A|$。结果对 $mod$ 取模。</p><p>$1\leq n\leq 600$，$1\leq a_{ij}\leq10^9+7$，$1≤p≤10^9+7。$</p><p>解答：</p><p>直接高斯消元除法会产生浮点数，而且 $mod$ 任意给定，除法不一定有逆元。所有要用到辗转相除法消元，如下：
$$
\left|
\begin{array}{cccc}
10 & a_{12} & \cdots &a_{1n}\\
4 & a_{22} & \cdots &a_{2n}\\
\vdots & \vdots & \ddots &\vdots\\
a_{n1} & a_{n2} & \cdots &a_{nn}
\end{array}
\right|
$$
只考虑 $\left|
\begin{array}{cccc}
10\\
4
\end{array}
\right|$ 这部分。</p><p>首先交换两个位置 $\left|
\begin{array}{cccc}
4\\
10
\end{array}
\right|$，然后 $10\%=4$ 得到 $\left|
\begin{array}{cccc}
4\\
2
\end{array}
\right|$。</p><p>再交换两个位置 $\left|
\begin{array}{cccc}
2\\
4
\end{array}
\right|$，然后 $4\%=2$ 得到 $\left|
\begin{array}{cccc}
2\\
0
\end{array}
\right|$。</p><p>这个代码对于 $a_{ij}$ 为 0 或者这个范围的负数应该也是适用的。</p><p>复杂度：</p><p>$O(n^2logn+n^3)$</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c++ data-lang=c++><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;bits/stdc++.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=k>using</span> <span class=k>namespace</span> <span class=n>std</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>typedef</span> <span class=kt>long</span> <span class=kt>long</span> <span class=n>ll</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=kt>int</span> <span class=n>N</span> <span class=o>=</span> <span class=mi>610</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>n</span><span class=p>,</span> <span class=n>mod</span><span class=p>,</span> <span class=n>a</span><span class=p>[</span><span class=n>N</span><span class=p>][</span><span class=n>N</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>gauss</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>res</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>while</span> <span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>i</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=kt>int</span> <span class=n>x</span> <span class=o>=</span> <span class=n>a</span><span class=p>[</span><span class=n>j</span><span class=p>][</span><span class=n>i</span><span class=p>]</span> <span class=o>/</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=n>i</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>k</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=n>a</span><span class=p>[</span><span class=n>j</span><span class=p>][</span><span class=n>k</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>j</span><span class=p>][</span><span class=n>k</span><span class=p>]</span> <span class=o>-</span> <span class=p>(</span><span class=n>ll</span><span class=p>)</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>k</span><span class=p>]</span> <span class=o>*</span> <span class=n>x</span> <span class=o>%</span> <span class=n>mod</span><span class=p>)</span> <span class=o>%</span> <span class=n>mod</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>swap</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>j</span><span class=p>],</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>]),</span> <span class=n>res</span> <span class=o>*=</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=n>swap</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>j</span><span class=p>],</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>]),</span> <span class=n>res</span> <span class=o>*=</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>res</span> <span class=o>=</span> <span class=p>(</span><span class=n>ll</span><span class=p>)</span><span class=n>res</span> <span class=o>*</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>i</span><span class=p>]</span> <span class=o>%</span> <span class=n>mod</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>(</span><span class=n>res</span> <span class=o>+</span> <span class=n>mod</span><span class=p>)</span> <span class=o>%</span> <span class=n>mod</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>scanf</span><span class=p>(</span><span class=s>&#34;%d%d&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>n</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>mod</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>scanf</span><span class=p>(</span><span class=s>&#34;%d&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>printf</span><span class=p>(</span><span class=s>&#34;%d</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>gauss</span><span class=p>());</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=next href=https://liuyilong.com/p/tech/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/><span class=title>下一页 »</span><br><span>组合数学</span></a></nav></footer><div><div class=pagination__title><span class=pagination__title-h style=font-size:20px>💬评论</span><hr></div><div id=tcomment></div><script src=https://cdn.staticfile.org/twikoo/1.6.10/twikoo.all.min.js></script>
<script>twikoo.init({envId:"https://twikoo-api-peach-psi.vercel.app/",el:"#tcomment",lang:"zh-CN",path:window.TWIKOO_MAGIC_PATH||window.location.pathname})</script></div></article></main><footer class=footer><span>&copy; 2023 <a href=https://liuyilong.com>liuyl's blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a><br></span><span id=busuanzi_container><span class="fa fa-user"></span> <span id=busuanzi_value_site_uv></span>
<span class="fa fa-eye"></span> <span id=busuanzi_value_site_pv></span></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="复制";function s(){t.innerHTML="已复制！",setTimeout(()=>{t.innerHTML="复制"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>